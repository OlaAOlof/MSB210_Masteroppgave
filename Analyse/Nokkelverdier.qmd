---
title: "Hedoniske Analyser"
author: 
  "Kevin Ha"
  "Ola Andre Olofsson"
format: pdf
editor: visual
---

# Setup

```{r setup}
library(readr)
library(tidyverse)
library(dplyr)
library(sf)
library(sp)
```

# Leser inn analyse datasettet vårt

```{r}
Analyse <- suppressWarnings(read_csv("Datasett_Analyse.csv"))
Analyse_2019 <- suppressWarnings(read_csv("Datasett_Analyse_2019.csv"))
Analyse_2020 <- suppressWarnings(read_csv("Datasett_Analyse_2020.csv"))
Analyse_2021 <- suppressWarnings(read_csv("Datasett_Analyse_2021.csv"))
Analyse_2022 <- suppressWarnings(read_csv("Datasett_Analyse_2022.csv"))

Analyse_sf <- suppressWarnings(st_read("Datasett_Analyse_sf.gpkg"))
Analyse_sf_2019 <- suppressWarnings(st_read("Datasett_Analyse_sf_2019.gpkg"))
Analyse_sf_2020 <- suppressWarnings(st_read("Datasett_Analyse_sf_2020.gpkg"))
Analyse_sf_2021 <- suppressWarnings(st_read("Datasett_Analyse_sf_2021.gpkg"))
Analyse_sf_2022 <- suppressWarnings(st_read("Datasett_Analyse_sf_2022.gpkg"))
```

```{r}
Analyse_sf$Bruksareal.Enhet <- as.numeric(Analyse_sf$Bruksareal.Enhet)
Analyse_sf$BRA.Bolig <- as.numeric(Analyse_sf$BRA.Bolig)
```

# Gjennomsnittsverdier

## Gjennomsnitt - Boligpris; hele datasettet

```{r}
mean(Analyse$P)
mean(Analyse_2019$P)
mean(Analyse_2020$P)
mean(Analyse_2021$P)
mean(Analyse_2022$P)
```

## Gjennomsnitt - Pris; Bergen

```{r}
Bergen <- Analyse_sf %>% 
  filter(Knr == 4601)
```

```{r}
Bergen_2019 <- Bergen[Bergen$DokumentAr == 2019,]
Bergen_2020 <- Bergen[Bergen$DokumentAr == 2020,]
Bergen_2021 <- Bergen[Bergen$DokumentAr == 2021,]
Bergen_2022 <- Bergen[Bergen$DokumentAr == 2022,]
```

```{r}
mean(Bergen$P)
mean(Bergen_2019$P)
mean(Bergen_2020$P)
mean(Bergen_2021$P)
mean(Bergen_2022$P)
```

## Gjennomsnitt - Pris; ekskludert Bergen

```{r}
Uten_Bergen <- Analyse_sf %>% 
  filter(Knr > 4601)
```

```{r}
Uten_Bergen_2019 <- Uten_Bergen[Uten_Bergen$DokumentAr == 2019,]
Uten_Bergen_2020 <- Uten_Bergen[Uten_Bergen$DokumentAr == 2020,]
Uten_Bergen_2021 <- Uten_Bergen[Uten_Bergen$DokumentAr == 2021,]
Uten_Bergen_2022 <- Uten_Bergen[Uten_Bergen$DokumentAr == 2022,]
```

```{r}
mean(Uten_Bergen$P)
mean(Uten_Bergen_2019$P)
mean(Uten_Bergen_2020$P)
mean(Uten_Bergen_2021$P)
mean(Uten_Bergen_2022$P)
```

## Gjennomsnitt - Energikarakter

```{r}
mean(Analyse$EL.Kar)
mean(Analyse_2019$EL.Kar)
mean(Analyse_2020$EL.Kar)
mean(Analyse_2021$EL.Kar)
mean(Analyse_2022$EL.Kar)
```

## Gjennomsnitt - Levert kWh:

```{r}
mean(Analyse$BLEnergikWh)
mean(Analyse_2019$BLEnergikWh)
mean(Analyse_2020$BLEnergikWh)
mean(Analyse_2021$BLEnergikWh)
mean(Analyse_2022$BLEnergikWh)
```

## Gjennomsnitt - Tomtestørrelse

```{r}
mean(Analyse$EiendomAreal)
mean(Analyse_2019$EiendomAreal)
mean(Analyse_2020$EiendomAreal)
mean(Analyse_2021$EiendomAreal)
mean(Analyse_2022$EiendomAreal)
```

## Gjennomsnitt - Boligstørrelse; Blokker

```{r}
Blokker <- Analyse_sf %>% 
  filter(Snr >= 1)
```

```{r}
Blokker_2019 <- Blokker[Blokker$DokumentAr == 2019,]
Blokker_2020 <- Blokker[Blokker$DokumentAr == 2020,]
Blokker_2021 <- Blokker[Blokker$DokumentAr == 2021,]
Blokker_2022 <- Blokker[Blokker$DokumentAr == 2022,]
```

```{r}
mean(Blokker$Bruksareal.Enhet)
mean(Blokker_2019$Bruksareal.Enhet)
mean(Blokker_2020$Bruksareal.Enhet)
mean(Blokker_2021$Bruksareal.Enhet)
mean(Blokker_2022$Bruksareal.Enhet)
```

## Gjennomsnitt - Boligstørrelse; Boliger

```{r}
Bolig <- Analyse_sf
```

```{r}
Bolig <- Bolig %>% 
  filter(Snr == 0)
```

```{r}
Bolig_2019 <- Bolig[Bolig$DokumentAr == 2019,]
Bolig_2020 <- Bolig[Bolig$DokumentAr == 2020,]
Bolig_2021 <- Bolig[Bolig$DokumentAr == 2021,]
Bolig_2022 <- Bolig[Bolig$DokumentAr == 2022,]
```

```{r}
mean(Bolig$BRA.Bolig)
mean(Bolig_2019$BRA.Bolig)
mean(Bolig_2020$BRA.Bolig)
mean(Bolig_2021$BRA.Bolig)
mean(Bolig_2022$BRA.Bolig)
```

## Gjennomsnitt - Bolig alder

```{r}
mean(Analyse$Alder)
mean(Analyse_2019$Alder)
mean(Analyse_2020$Alder)
mean(Analyse_2021$Alder)
mean(Analyse_2022$Alder)
```

## Gjennomsnitt - Avstand til sentrum i km

```{r}
mean(Analyse_sf$dist_cbd_km)
mean(Analyse_sf_2019$dist_cbd_km)
mean(Analyse_sf_2020$dist_cbd_km)
mean(Analyse_sf_2021$dist_cbd_km)
mean(Analyse_sf_2022$dist_cbd_km)
```

# Median verdier

## Median - Boligpris; hele datasettet

```{r}
median(Analyse$P)
median(Analyse_2019$P)
median(Analyse_2020$P)
median(Analyse_2021$P)
median(Analyse_2022$P)
```

## Median - Pris; Bergen

```{r}
median(Bergen$P)
median(Bergen_2019$P)
median(Bergen_2020$P)
median(Bergen_2021$P)
median(Bergen_2022$P)
```

## Median - Pris; eksludert Bergen

```{r}
median(Uten_Bergen$P)
median(Uten_Bergen_2019$P)
median(Uten_Bergen_2020$P)
median(Uten_Bergen_2021$P)
median(Uten_Bergen_2022$P)
```

## Median - Energikarakterer

```{r}
median(Analyse$EL.Kar)
median(Analyse_2019$EL.Kar)
median(Analyse_2020$EL.Kar)
median(Analyse_2021$EL.Kar)
median(Analyse_2022$EL.Kar)
```

## Median - Levert kWh

```{r}
median(Analyse$BLEnergikWh)
median(Analyse_2019$BLEnergikWh)
median(Analyse_2020$BLEnergikWh)
median(Analyse_2021$BLEnergikWh)
median(Analyse_2022$BLEnergikWh)
```

## Median - Tomtestørrelse

```{r}
median(Analyse$EiendomAreal)
median(Analyse_2019$EiendomAreal)
median(Analyse_2020$EiendomAreal)
median(Analyse_2021$EiendomAreal)
median(Analyse_2022$EiendomAreal)
```

## Median - Boligstørrelse; Blokker

```{r}
median(Blokker$Bruksareal.Enhet)
median(Blokker_2019$Bruksareal.Enhet)
median(Blokker_2020$Bruksareal.Enhet)
median(Blokker_2021$Bruksareal.Enhet)
median(Blokker_2022$Bruksareal.Enhet)
```

## Median - Boligstørrelse; Boliger

```{r}
median(Bolig$BRA.Bolig)
median(Bolig_2019$BRA.Bolig)
median(Bolig_2020$BRA.Bolig)
median(Bolig_2021$BRA.Bolig)
median(Bolig_2022$BRA.Bolig)
```

## Median - Bolig alder

```{r}
median(Analyse$Alder)
median(Analyse_2019$Alder)
median(Analyse_2020$Alder)
median(Analyse_2021$Alder)
median(Analyse_2022$Alder)
```

## Median - Avstand til sentrum i km

```{r}
median(Analyse_sf$dist_cbd_km)
median(Analyse_sf_2019$dist_cbd_km)
median(Analyse_sf_2020$dist_cbd_km)
median(Analyse_sf_2021$dist_cbd_km)
median(Analyse_sf_2022$dist_cbd_km)
```

# Varians verdier

## Varians - Boligpris; hele datasettet

```{r}
var(Analyse$P)
var(Analyse_2019$P)
var(Analyse_2020$P)
var(Analyse_2021$P)
var(Analyse_2022$P)
```

## Varians - Pris; Bergen

```{r}
var(Bergen$P)
var(Bergen_2019$P)
var(Bergen_2020$P)
var(Bergen_2021$P)
var(Bergen_2022$P)
```

## Varians - Pris; eksludert Bergen

```{r}
var(Uten_Bergen$P)
var(Uten_Bergen_2019$P)
var(Uten_Bergen_2020$P)
var(Uten_Bergen_2021$P)
var(Uten_Bergen_2022$P)
```

## Varians - Energikarakterer

```{r}
var(Analyse$EL.Kar)
var(Analyse_2019$EL.Kar)
var(Analyse_2020$EL.Kar)
var(Analyse_2021$EL.Kar)
var(Analyse_2022$EL.Kar)
```

## Varians - Levert kWh

```{r}
var(Analyse$BLEnergikWh)
var(Analyse_2019$BLEnergikWh)
var(Analyse_2020$BLEnergikWh)
var(Analyse_2021$BLEnergikWh)
var(Analyse_2022$BLEnergikWh)
```

## Varians - Tomtestørrelse

```{r}
var(Analyse$EiendomAreal)
var(Analyse_2019$EiendomAreal)
var(Analyse_2020$EiendomAreal)
var(Analyse_2021$EiendomAreal)
var(Analyse_2022$EiendomAreal)
```

## Varians - Boligstørrelse; Blokker

```{r}
var(Blokker$Bruksareal.Enhet)
var(Blokker_2019$Bruksareal.Enhet)
var(Blokker_2020$Bruksareal.Enhet)
var(Blokker_2021$Bruksareal.Enhet)
var(Blokker_2022$Bruksareal.Enhet)
```

## Varians - Boligstørrelse; Boliger

```{r}
var(Bolig$BRA.Bolig)
var(Bolig_2019$BRA.Bolig)
var(Bolig_2020$BRA.Bolig)
var(Bolig_2021$BRA.Bolig)
var(Bolig_2022$BRA.Bolig)
```

## Varians - Bolig alder

```{r}
var(Analyse$Alder)
var(Analyse_2019$Alder)
var(Analyse_2020$Alder)
var(Analyse_2021$Alder)
var(Analyse_2022$Alder)
```

## Varians - Avstand til sentrum i km

```{r}
var(Analyse_sf$dist_cbd_km)
var(Analyse_sf_2019$dist_cbd_km)
var(Analyse_sf_2020$dist_cbd_km)
var(Analyse_sf_2021$dist_cbd_km)
var(Analyse_sf_2022$dist_cbd_km)
```

# Makspris

Boliger:

```{r}
Bergen_Bolig <- Bolig %>% 
  filter(Knr == 4601)
Bergen_Bolig_2019<- Bolig_2019 %>% 
  filter(Knr == 4601)
Bergen_Bolig_2020 <- Bolig_2020 %>% 
  filter(Knr == 4601)
Bergen_Bolig_2021 <- Bolig_2021 %>% 
  filter(Knr == 4601)
Bergen_Bolig_2022 <- Bolig_2022 %>% 
  filter(Knr == 4601)
```

```{r}
Uten_Bergen_Bolig <- Bolig %>% 
  filter(Knr > 4601)
Uten_Bergen_Bolig_2019<- Bolig_2019 %>% 
  filter(Knr > 4601)
Uten_Bergen_Bolig_2020 <- Bolig_2020 %>% 
  filter(Knr > 4601)
Uten_Bergen_Bolig_2021 <- Bolig_2021 %>% 
  filter(Knr > 4601)
Uten_Bergen_Bolig_2022 <- Bolig_2022 %>% 
  filter(Knr > 4601)
```

Blokker:

```{r}
Bergen_Blokker <- Blokker %>% 
  filter(Knr == 4601)
Bergen_Blokker_2019<- Blokker_2019 %>% 
  filter(Knr == 4601)
Bergen_Blokker_2020 <- Blokker_2020 %>% 
  filter(Knr == 4601)
Bergen_Blokker_2021 <- Blokker_2021 %>% 
  filter(Knr == 4601)
Bergen_Blokker_2022 <- Blokker_2022 %>% 
  filter(Knr == 4601)
```

```{r}
Uten_Bergen_Blokker <- Blokker %>% 
  filter(Knr > 4601)
Uten_Bergen_Blokker_2019<- Blokker_2019 %>% 
  filter(Knr > 4601)
Uten_Bergen_Blokker_2020 <- Blokker_2020 %>% 
  filter(Knr > 4601)
Uten_Bergen_Blokker_2021 <- Blokker_2021 %>% 
  filter(Knr > 4601)
Uten_Bergen_Blokker_2022 <- Blokker_2022 %>% 
  filter(Knr > 4601)
```

```{r}
#Bergen_2019 <- Bergen[Bergen$DokumentAr == 2019,]
#Bergen_2020 <- Bergen[Bergen$DokumentAr == 2020,]
#Bergen_2021 <- Bergen[Bergen$DokumentAr == 2021,]
#Bergen_2022 <- Bergen[Bergen$DokumentAr == 2022,]
```

## Makspris - Bergen

```{r}
options(scipen = 999)
max(Bergen$P)
max(Bergen_2019$P)
max(Bergen_2020$P)
max(Bergen_2021$P)
max(Bergen_2022$P)
```

## Makspris Boliger - Bergen

```{r}
options(scipen = 999)
max(Bergen_Bolig$P)
max(Bergen_Bolig_2019$P)
max(Bergen_Bolig_2020$P)
max(Bergen_Bolig_2021$P)
max(Bergen_Bolig_2022$P)
```

## Makspris Blokker - Bergen

```{r}
options(scipen = 999)
max(Bergen$P)
max(Bergen_Blokker_2019$P)
max(Bergen_Blokker_2020$P)
max(Bergen_Blokker_2021$P)
max(Bergen_Blokker_2022$P)
```

## Makspris - Eksl. Bergen

```{r}
options(scipen = 999)
max(Uten_Bergen$P)
max(Uten_Bergen_2019$P)
max(Uten_Bergen_2020$P)
max(Uten_Bergen_2021$P)
max(Uten_Bergen_2022$P)
```

## Makspris Boliger - Eksl. Bergen

```{r}
options(scipen = 999)
max(Uten_Bergen_Bolig$P)
max(Uten_Bergen_Bolig_2019$P)
max(Uten_Bergen_Bolig_2020$P)
max(Uten_Bergen_Bolig_2021$P)
max(Uten_Bergen_Bolig_2022$P)
```

## Makspris Blokker - Eksl. Bergen

```{r}
options(scipen = 999)
max(Uten_Bergen$P)
max(Uten_Bergen_Blokker_2019$P)
max(Uten_Bergen_Blokker_2020$P)
max(Uten_Bergen_Blokker_2021$P)
max(Uten_Bergen_Blokker_2022$P)
```

# Minpris

## Minpris - Bergen

```{r}
options(scipen = 999)
min(Bergen$P)
min(Bergen_2019$P)
min(Bergen_2020$P)
min(Bergen_2021$P)
min(Bergen_2022$P)
```

## Minpris Boliger - Bergen

```{r}
options(scipen = 999)
min(Bergen_Bolig$P)
min(Bergen_Bolig_2019$P)
min(Bergen_Bolig_2020$P)
min(Bergen_Bolig_2021$P)
min(Bergen_Bolig_2022$P)
```

## Minpris Blokker - Bergen

```{r}
options(scipen = 999)
min(Bergen$P)
min(Bergen_Blokker_2019$P)
min(Bergen_Blokker_2020$P)
min(Bergen_Blokker_2021$P)
min(Bergen_Blokker_2022$P)
```

## Minpris - Eksl. Bergen

```{r}
options(scipen = 999)
min(Uten_Bergen$P)
min(Uten_Bergen_2019$P)
min(Uten_Bergen_2020$P)
min(Uten_Bergen_2021$P)
min(Uten_Bergen_2022$P)
```

## Minpris Boliger - Eksl. Bergen

```{r}
min(Uten_Bergen_Bolig$P)
min(Uten_Bergen_Bolig_2019$P)
min(Uten_Bergen_Bolig_2020$P)
min(Uten_Bergen_Bolig_2021$P)
min(Uten_Bergen_Bolig_2022$P)
```

## Minpris Blokker - Eksl. Bergen

```{r}
options(scipen = 999)
min(Uten_Bergen$P)
min(Uten_Bergen_Blokker_2019$P)
min(Uten_Bergen_Blokker_2020$P)
min(Uten_Bergen_Blokker_2021$P)
min(Uten_Bergen_Blokker_2022$P)
```

# Kvadratmeter Pris

```{r}
Bolig_pm2 <- Bolig %>% 
  select(P, Bruksareal.Enhet, BRA.Bolig, BRA.Tot, DokumentAr, Matrikkel, Postnummer, GateAdresse, Knr)
```

```{r}
Bolig_pm2 <- transform(Bolig_pm2, BRA.Tot = as.numeric(BRA.Tot))
```

```{r}
Blokker_pm2 <- Blokker %>% 
  select(P, Bruksareal.Enhet, BRA.Tot, DokumentAr, Matrikkel, Postnummer, GateAdresse, Knr)
```

```{r}
Bolig_pm2 <- Bolig_pm2 %>% 
  mutate(pm2 = P/Bruksareal.Enhet)
```

```{r}
Bolig_pm2$pm2[Bolig_pm2$pm2 == 'Inf'] <- 0
```

```{r}
Bolig_pm2_Bergen <- Bolig_pm2 %>% 
  filter(Knr == 4601)
```

```{r}
Bolig_pm2_Uten_Bergen <- Bolig_pm2 %>% 
  filter(Knr > 4601)
```

```{r}
Bolig_pm2_Bergen_2019 <- Bolig_pm2_Bergen[Bolig_pm2_Bergen$DokumentAr == 2019,]
Bolig_pm2_Bergen_2020 <- Bolig_pm2_Bergen[Bolig_pm2_Bergen$DokumentAr == 2020,]
Bolig_pm2_Bergen_2021 <- Bolig_pm2_Bergen[Bolig_pm2_Bergen$DokumentAr == 2021,]
Bolig_pm2_Bergen_2022 <- Bolig_pm2_Bergen[Bolig_pm2_Bergen$DokumentAr == 2022,]
```

```{r}
Bolig_pm2_Uten_Bergen_2019 <- Bolig_pm2_Uten_Bergen[Bolig_pm2_Uten_Bergen$DokumentAr == 2019,]
Bolig_pm2_Uten_Bergen_2020 <- Bolig_pm2_Uten_Bergen[Bolig_pm2_Uten_Bergen$DokumentAr == 2020,]
Bolig_pm2_Uten_Bergen_2021 <- Bolig_pm2_Uten_Bergen[Bolig_pm2_Uten_Bergen$DokumentAr == 2021,]
Bolig_pm2_Uten_Bergen_2022 <- Bolig_pm2_Uten_Bergen[Bolig_pm2_Uten_Bergen$DokumentAr == 2022,]
```

```{r}
Blokker_pm2 <- transform(Blokker_pm2, BRA.Tot = as.numeric(BRA.Tot))
```

```{r}
Blokker_pm2 <- Blokker_pm2 %>% 
  mutate(pm2 = P/Bruksareal.Enhet)
```

```{r}
Blokker_pm2$pm2[Blokker_pm2$pm2 == 'Inf'] <- 0
```

```{r}
Blokker_pm2_Bergen <- Blokker_pm2 %>% 
  filter(Knr == 4601)
```

```{r}
Blokker_pm2_Uten_Bergen <- Blokker_pm2 %>% 
  filter(Knr > 4601)
```

```{r}
Blokker_pm2_Bergen_2019 <- Blokker_pm2_Bergen[Blokker_pm2_Bergen$DokumentAr == 2019,]
Blokker_pm2_Bergen_2020 <- Blokker_pm2_Bergen[Blokker_pm2_Bergen$DokumentAr == 2020,]
Blokker_pm2_Bergen_2021 <- Blokker_pm2_Bergen[Blokker_pm2_Bergen$DokumentAr == 2021,]
Blokker_pm2_Bergen_2022 <- Blokker_pm2_Bergen[Blokker_pm2_Bergen$DokumentAr == 2022,]
```

```{r}
Blokker_pm2_Uten_Bergen_2019 <- Blokker_pm2_Uten_Bergen[Blokker_pm2_Uten_Bergen$DokumentAr == 2019,]
Blokker_pm2_Uten_Bergen_2020 <- Blokker_pm2_Uten_Bergen[Blokker_pm2_Uten_Bergen$DokumentAr == 2020,]
Blokker_pm2_Uten_Bergen_2021 <- Blokker_pm2_Uten_Bergen[Blokker_pm2_Uten_Bergen$DokumentAr == 2021,]
Blokker_pm2_Uten_Bergen_2022 <- Blokker_pm2_Uten_Bergen[Blokker_pm2_Uten_Bergen$DokumentAr == 2022,]
```

## KvM Pris - Bergen; Bolig

### Max

```{r}
max(Bolig_pm2_Bergen$pm2)
max(Bolig_pm2_Bergen_2019$pm2)
max(Bolig_pm2_Bergen_2020$pm2)
max(Bolig_pm2_Bergen_2021$pm2)
max(Bolig_pm2_Bergen_2022$pm2)
```

### Min

**NOTE: Me har eit par observasjonar som eg ikkje får med her, grunna at Ambita ikkje skille naturlig mellom blokker og boligar. Me får Vurdera ka me ska gjera med da. Enten 1. Ta vekk dei observasjonane når me kjøre Min/Max opplegget, eller finna ein anna løysning. Eg har ingen andre løysninga her og no ihvertfall.**

```{r}
min(Bolig_pm2_Bergen$pm2)
min(Bolig_pm2_Bergen_2019$pm2)
min(Bolig_pm2_Bergen_2020$pm2)
min(Bolig_pm2_Bergen_2021$pm2)
min(Bolig_pm2_Bergen_2022$pm2)
```

### Gjennomsnitt

```{r}
mean(Bolig_pm2_Bergen$pm2)
mean(Bolig_pm2_Bergen_2019$pm2)
mean(Bolig_pm2_Bergen_2020$pm2)
mean(Bolig_pm2_Bergen_2021$pm2)
mean(Bolig_pm2_Bergen_2022$pm2)
```

### Median

```{r}
median(Bolig_pm2_Bergen$pm2)
median(Bolig_pm2_Bergen_2019$pm2)
median(Bolig_pm2_Bergen_2020$pm2)
median(Bolig_pm2_Bergen_2021$pm2)
median(Bolig_pm2_Bergen_2022$pm2)
```

### Varians

```{r}
var(Bolig_pm2_Bergen$pm2)
var(Bolig_pm2_Bergen_2019$pm2)
var(Bolig_pm2_Bergen_2020$pm2)
var(Bolig_pm2_Bergen_2021$pm2)
var(Bolig_pm2_Bergen_2022$pm2)
```

## KvM Pris - Bergen; Blokker

### Max

```{r}
max(Blokker_pm2_Bergen$pm2)
max(Blokker_pm2_Bergen_2019$pm2)
max(Blokker_pm2_Bergen_2020$pm2)
max(Blokker_pm2_Bergen_2021$pm2)
max(Blokker_pm2_Bergen_2022$pm2)
```

### Min

**NOTE: Me har eit par observasjonar som eg ikkje får med her, grunna at Ambita ikkje skille naturlig mellom blokker og boligar. Me får Vurdera ka me ska gjera med da. Enten 1. Ta vekk dei observasjonane når me kjøre Min/Max opplegget, eller finna ein anna løysning. Eg har ingen andre løysninga her og no ihvertfall.**

```{r}
min(Blokker_pm2_Bergen$pm2)
min(Blokker_pm2_Bergen_2019$pm2)
min(Blokker_pm2_Bergen_2020$pm2)
min(Blokker_pm2_Bergen_2021$pm2)
min(Blokker_pm2_Bergen_2022$pm2)
```

### Gjennomsnitt

```{r}
mean(Blokker_pm2_Bergen$pm2)
mean(Blokker_pm2_Bergen_2019$pm2)
mean(Blokker_pm2_Bergen_2020$pm2)
mean(Blokker_pm2_Bergen_2021$pm2)
mean(Blokker_pm2_Bergen_2022$pm2)
```

### Median

```{r}
median(Blokker_pm2_Bergen$pm2)
median(Blokker_pm2_Bergen_2019$pm2)
median(Blokker_pm2_Bergen_2020$pm2)
median(Blokker_pm2_Bergen_2021$pm2)
median(Blokker_pm2_Bergen_2022$pm2)
```

### Varians

```{r}
var(Blokker_pm2_Bergen$pm2)
var(Blokker_pm2_Bergen_2019$pm2)
var(Blokker_pm2_Bergen_2020$pm2)
var(Blokker_pm2_Bergen_2021$pm2)
var(Blokker_pm2_Bergen_2022$pm2)
```

## KvM Pris - Eksl. Bergen; Bolig

### Max

```{r}
max(Bolig_pm2_Uten_Bergen$pm2)
max(Bolig_pm2_Uten_Bergen_2019$pm2)
max(Bolig_pm2_Uten_Bergen_2020$pm2)
max(Bolig_pm2_Uten_Bergen_2021$pm2)
max(Bolig_pm2_Uten_Bergen_2022$pm2)
```

### Min

**NOTE: Me har eit par observasjonar som eg ikkje får med her, grunna at Ambita ikkje skille naturlig mellom blokker og boligar. Me får Vurdera ka me ska gjera med da. Enten 1. Ta vekk dei observasjonane når me kjøre Min/Max opplegget, eller finna ein anna løysning. Eg har ingen andre løysninga her og no ihvertfall.**

```{r}
min(Bolig_pm2_Uten_Bergen$pm2)
min(Bolig_pm2_Uten_Bergen_2019$pm2)
min(Bolig_pm2_Uten_Bergen_2020$pm2)
min(Bolig_pm2_Uten_Bergen_2021$pm2)
min(Bolig_pm2_Uten_Bergen_2022$pm2)
```

### Gjennomsnitt

```{r}
mean(Bolig_pm2_Uten_Bergen$pm2)
mean(Bolig_pm2_Uten_Bergen_2019$pm2)
mean(Bolig_pm2_Uten_Bergen_2020$pm2)
mean(Bolig_pm2_Uten_Bergen_2021$pm2)
mean(Bolig_pm2_Uten_Bergen_2022$pm2)
```

### Median

```{r}
median(Bolig_pm2_Uten_Bergen$pm2)
median(Bolig_pm2_Uten_Bergen_2019$pm2)
median(Bolig_pm2_Uten_Bergen_2020$pm2)
median(Bolig_pm2_Uten_Bergen_2021$pm2)
median(Bolig_pm2_Uten_Bergen_2022$pm2)
```

### Varians

```{r}
var(Bolig_pm2_Uten_Bergen$pm2)
var(Bolig_pm2_Uten_Bergen_2019$pm2)
var(Bolig_pm2_Uten_Bergen_2020$pm2)
var(Bolig_pm2_Uten_Bergen_2021$pm2)
var(Bolig_pm2_Uten_Bergen_2022$pm2)
```

## KvM Pris - Eksl. Bergen; Blokker

### Max

```{r}
max(Blokker_pm2_Uten_Bergen$pm2)
max(Blokker_pm2_Uten_Bergen_2019$pm2)
max(Blokker_pm2_Uten_Bergen_2020$pm2)
max(Blokker_pm2_Uten_Bergen_2021$pm2)
max(Blokker_pm2_Uten_Bergen_2022$pm2)
```

### Min

**NOTE: Me har eit par observasjonar som eg ikkje får med her, grunna at Ambita ikkje skille naturlig mellom blokker og boligar. Me får Vurdera ka me ska gjera med da. Enten 1. Ta vekk dei observasjonane når me kjøre Min/Max opplegget, eller finna ein anna løysning. Eg har ingen andre løysninga her og no ihvertfall.**

```{r}
min(Blokker_pm2_Uten_Bergen$pm2)
min(Blokker_pm2_Uten_Bergen_2019$pm2)
min(Blokker_pm2_Uten_Bergen_2020$pm2)
min(Blokker_pm2_Uten_Bergen_2021$pm2)
min(Blokker_pm2_Uten_Bergen_2022$pm2)
```

### Gjennomsnitt

```{r}
mean(Blokker_pm2_Uten_Bergen$pm2)
mean(Blokker_pm2_Uten_Bergen_2019$pm2)
mean(Blokker_pm2_Uten_Bergen_2020$pm2)
mean(Blokker_pm2_Uten_Bergen_2021$pm2)
mean(Blokker_pm2_Uten_Bergen_2022$pm2)
```

### Median

```{r}
median(Blokker_pm2_Uten_Bergen$pm2)
median(Blokker_pm2_Uten_Bergen_2019$pm2)
median(Blokker_pm2_Uten_Bergen_2020$pm2)
median(Blokker_pm2_Uten_Bergen_2021$pm2)
median(Blokker_pm2_Uten_Bergen_2022$pm2)
```

### Varians

```{r}
var(Blokker_pm2_Uten_Bergen$pm2)
var(Blokker_pm2_Uten_Bergen_2019$pm2)
var(Blokker_pm2_Uten_Bergen_2020$pm2)
var(Blokker_pm2_Uten_Bergen_2021$pm2)
var(Blokker_pm2_Uten_Bergen_2022$pm2)
```

# Flytter pm2 kolonner inn i Datasett som skal brukes til hedoniske analyser

## Boliger

### Boliger, inkludert Bergen

```{r}
Bolig$pm2 <- Bolig_pm2$pm2
```

```{r}
Bolig$pm2 <- as.character(Bolig$pm2)
```

```{r}
Bolig <- Bolig %>% 
  relocate(pm2, .after = P)
```

```{r}
Bolig$pm2 <- as.numeric(Bolig$pm2)
```

### Boliger, eksludert Bergen

```{r}
Uten_Bergen_Bolig$pm2 <- Bolig_pm2_Uten_Bergen$pm2
```

```{r}
Uten_Bergen_Bolig$pm2 <- as.character(Uten_Bergen_Bolig$pm2)
```

```{r}
Uten_Bergen_Bolig <- Uten_Bergen_Bolig %>% 
  relocate(pm2, .after = P)
```

```{r}
Uten_Bergen_Bolig$pm2 <- as.numeric(Uten_Bergen_Bolig$pm2)
```

## Blokker

### Blokker, inkludert Bergen

```{r}
Blokker$pm2 <- Blokker_pm2$pm2
```

```{r}
Blokker$pm2 <- as.character(Blokker_pm2$pm2)
```

```{r}
Blokker <- Blokker %>% 
  relocate(pm2, .after = P)
```

```{r}
Blokker$pm2 <- as.numeric(Blokker$pm2)
```

### Blokker, eksludert Bergen

```{r}
Uten_Bergen_Blokker$pm2 <- Blokker_pm2_Uten_Bergen$pm2
```

```{r}
Uten_Bergen_Blokker$pm2 <- as.character(Blokker_pm2_Uten_Bergen$pm2)
```

```{r}
Uten_Bergen_Blokker <- Uten_Bergen_Blokker %>% 
  relocate(pm2, .after = P)
```

```{r}
Uten_Bergen_Blokker$pm2 <- as.numeric(Uten_Bergen_Blokker$pm2)
```

#### Skriver ut filene for vidare analyse

```{r}
#write.csv(Bolig, "Bolig_Inkludert_Bergen.csv")
#write.csv(Uten_Bergen_Bolig, "Bolig_Ekskludert_Bergen.csv")
#write.csv(Blokker, "Blokker_Inkludert_Bergen.csv")
#write.csv(Uten_Bergen_Blokker, "Blokker_Ekskludert_Bergen.csv")
```

```{r}
#st_write(Bolig, "Bolig_Inkludert_Bergen.gpkg")
#st_write(Uten_Bergen_Bolig, "Bolig_Ekskludert_Bergen.gpkg")
#st_write(Blokker, "Blokker_Inkludert_Bergen.gpkg")
#st_write(Uten_Bergen_Blokker, "Blokker_Ekskludert_Bergen.gpkg")
```

# Rydder ut datasett

**LEGGA INN DEI NYE DATASETTENE. ORKE IKKJE Å GJERA DA NO. ALTFOR TRØTT!**

```{r}
rm(#Bergen,
   Bergen_2019,
   Bergen_2020,
   Bergen_2021,
   Bergen_2022,
   #Uten_Bergen,
   Uten_Bergen_2019,
   Uten_Bergen_2020,
   Uten_Bergen_2021,
   Uten_Bergen_2022,
   #Blokker,
   Blokker_2019,
   Blokker_2020,
   Blokker_2021,
   Blokker_2022,
   #Bolig,
   Bolig_2019,
   Bolig_2020,
   Bolig_2021,
   Bolig_2022)
```

# Fremstilling og Plots av variabler

## EL-Karakter; Frekvens:

```{r}
hist(Analyse$EL.Kar, breaks = 5, main = "Frekvens, ulike energikarakterer", xlab = "EL.Kar.Original", col = "lightblue", border = "black")
```

## 

```{r}
library(scales)
library(ggplot2)
library(dplyr)
# Regner ut snittpris for hvert kvartal
Gjennomsnittlig_kvartalspris <- Analyse %>%
  group_by(YearQuarter) %>%
  summarize(Gjenomsnittspris = mean(pm2))

# Definerer strømkrisen
start <- "2021Q3"
end <- "2022Q1"

# Linjediagram
ggplot(Gjennomsnittlig_kvartalspris, aes(x = YearQuarter, y = Gjenomsnittspris, group = 1)) +
  geom_rect(aes(xmin = start, xmax = end, ymin = -Inf, ymax = Inf),
            fill = "grey", alpha = 0.1) +
  geom_line(aes(color = Gjenomsnittspris)) +
  geom_point() +
  scale_y_continuous(labels = comma) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(x = "Aar og kvartal", y = "Gjennomsnittlig boligpris", title = "Gjennomsnittlig kvartalspris med stromkrisen i graa sone")
```
